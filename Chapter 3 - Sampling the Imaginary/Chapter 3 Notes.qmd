---
title: "Chapter 3 - Sampling the Imaginary"
format: html
---

```{r}
library(rethinking)
library(posterior)
library(cmdstanr)
library(tidyverse)

theme_set(theme_minimal())
```


```{r}
Pr_Positive_Vampire <- 0.95
Pr_Positive_Mortal <- 0.01
Pr_Vampire <- 0.001
Pr_Positive <- Pr_Positive_Vampire * Pr_Vampire + Pr_Positive_Mortal * (1 - Pr_Vampire)
Pr_Vampire_Positive <- Pr_Positive_Vampire * Pr_Vampire / Pr_Positive

Pr_Vampire_Positive
```

## 3.1 Sampling from a grid-approximate posterior

```{r}
p_grid <- seq(from = 0, to = 1, length.out = 1000)
prior <- rep(1, 1000)
likelihood <- dbinom(x = 6, size = 9, prob = p_grid)

unstd_posterior <- likelihood * prior
posterior <- unstd_posterior / sum(unstd_posterior)
```

```{r}
samples <- sample(x = p_grid, size = 10000, replace = TRUE, prob = posterior)

samples_data <- tibble(
    sample_number = 1:length(samples),
    samples = samples
)

samples_data |>
    ggplot(aes(x = sample_number, y = samples)) +
    geom_point(alpha = 0.4)

samples_data |>
    ggplot(aes(x = samples)) +
    geom_density()
```

## 3.2 Sampling to summarize

### 3.2.1 Intervals of defined boundaries
```{r}
sum(posterior[p_grid < 0.5])
```

```{r}
sum(samples < 0.5) / 1e4
```

```{r}
sum(samples > 0.5 & samples < 0.75) / 1e4
```

```{r}
quantile(samples, 0.8)
```